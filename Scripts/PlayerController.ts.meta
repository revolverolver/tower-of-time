fileFormatVersion: 2
guid: 6a34c31e5ba1c4d488d96cc33dfda594
ScriptedImporter:
  internalIDToNameTable: []
  externalObjects: {}
  serializedVersion: 2
  userData: 
  assetBundleName: 
  assetBundleVariant: 
  script: {fileID: 11500000, guid: 22604dd76f55453daccee3ed9e7b94b5, type: 3}
  SerializedAsset: '{"__scriptableObject__name":"PlayerController","__scriptableObject__type":"Genies.Scripting.AssetTypes.TsAsset,
    Genies.Scripting, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null","IsCompiled":true,"CompilerVersion":"2.0.66","ReferencedSpecifiers":["@assets/Experience/tower-of-time/Scripts/GameManager","@assets/Experience/tower-of-time/Scripts/TreeObject","@assets/Experience/tower-of-time/Scripts/WoodBackpack","@assets/Experience/tower-of-time/Scripts/CameraMovement","@assets/Experience/tower-of-time/Scripts/PlayerHealth","@assets/Experience/tower-of-time/Scripts/Upgrades","@assets/Experience/tower-of-time/Scripts/PlayerStats"],"Source":"\"use
    strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst
    UnityEngine_1 = require(\"UnityEngine\");\nconst Genies_Avatars_Sdk_1 = require(\"Genies.Avatars.Sdk\");\nconst
    WoodBackpack_1 = require(\"@assets/Experience/tower-of-time/Scripts/WoodBackpack\");\nconst
    CameraMovement_1 = require(\"@assets/Experience/tower-of-time/Scripts/CameraMovement\");\nconst
    PlayerHealth_1 = require(\"@assets/Experience/tower-of-time/Scripts/PlayerHealth\");\nconst
    Upgrades_1 = require(\"@assets/Experience/tower-of-time/Scripts/Upgrades\");\nconst
    PlayerStats_1 = require(\"@assets/Experience/tower-of-time/Scripts/PlayerStats\");\nclass
    PlayerController extends UnityEngine_1.MonoBehaviour {\n    constructor() {\n       
    super(...arguments);\n        this.playerSpeed = 2.2;\n        this.canMove =
    false;\n    }\n    async Start() {\n        //Get GameManager singleton and add
    a listener to OnGameStateChange event\n        this.gameManager = CameraMovement_1.default.Instance;\n       
    this.gameManager.OnCameraStateChange.addListener(this.CheckGameState, //@ts-ignore\n       
    this);\n        //Initialize the SDK\n        await $promise(Genies_Avatars_Sdk_1.GeniesAvatarsSdk.InitializeAsync());\n       
    //Load the user Avatar\n        this.userAvatar = await $promise(Genies_Avatars_Sdk_1.GeniesAvatarsSdk.LoadUserAvatarAsync(\"UserAvatar\",
    this.transform, this.playerAnimator));\n        //send message to GameManager
    that the Avatar has been loaded\n        this.gameManager.ChangeCameraState(CameraMovement_1.CameraState.MAIN_MENU);\n       
    PlayerController.movement = 0;\n    }\n    /** Manages the player logic when
    the game state changes. @param newState */\n    CheckGameState(newState) {\n       
    switch (newState) {\n            case CameraMovement_1.CameraState.FOLLOWING_PLAYER:\n               
    this.OnGamePlay();\n                break;\n            default:\n               
    this.canMove = false;\n                break;\n        }\n    }\n    /** This
    will manage the player once the game starts. */\n    OnGamePlay() {\n       
    this.canMove = true;\n        //this.transform.position = Vector3.zero;\n       
    // @ts-ignore\n        this.userAvatar.Animator.SetFloat_EBB7509C_H45FF9778((\"idle_run_walk\"),
    (0));\n    }\n    FixedUpdate() {\n        //If game is playing, move player
    according to joystick input\n        if (this.canMove) {\n            this.MovePlayer();\n           
    this.RotatePlayer();\n        }\n        else {\n            this.rb.velocity
    = UnityEngine_1.Vector3.zero;\n        }\n    }\n    ChangeAnimatorState(state)
    {\n        // @ts-ignore\n        this.userAvatar.Animator.SetFloat_EBB7509C_H45FF9778((\"idle_run_walk\"),
    state);\n    }\n    GameOver() {\n        this.canMove = false;\n        this.userAvatar.Animator.speed
    = 1;\n        // @ts-ignore\n        this.userAvatar.Animator.SetFloat_EBB7509C_H45FF9778((\"idle_run_walk\"),
    (0));\n        this.userAvatar.Animator.SetTrigger(\"slip\");\n    }\n    /**
    Gets the direction of the joystick input */\n    GetJoystickInput(direction,
    value) {\n        if (!PlayerHealth_1.default.isAlive)\n            return;\n       
    if (value > 5) {\n            value = value * 0.012;\n            // Change value
    based on weight\n            let weight = ((WoodBackpack_1.default.woodAmount
    / 20) * 0.45) / 1.4 * Upgrades_1.default.carryStrength * PlayerStats_1.default.carryBoost;\n           
    value -= weight;\n            this.moveDirection = // @ts-ignore\n               
    UnityEngine_1.Vector3.op_Multiply_EBB7509C_H75CC56AF(direction.normalized, -value);\n           
    this.userAvatar.Animator.speed = value * 0.75;\n        }\n        else {\n           
    this.moveDirection = UnityEngine_1.Vector3.zero;\n            value = value *
    0.012;\n        }\n        // Put Camera Look Target further away when moving
    faster\n        value *= 0.9;\n        let localTarget = new UnityEngine_1.Vector3(0,
    0, value * 0.6);\n        this.cameraTarget.localPosition = UnityEngine_1.Vector3.Lerp(this.cameraTarget.localPosition,
    localTarget, UnityEngine_1.Time.deltaTime * 6);\n        // Public Movement speed\n       
    value *= 0.9;\n        PlayerController.movement = value;\n    }\n    /** Moves
    the player in the direction of the joystick */\n    MovePlayer() {\n        if
    (UnityEngine_1.Vector3.op_Equality(this.moveDirection, UnityEngine_1.Vector3.zero))\n           
    return;\n        // Set player speed\n        let speed = this.playerSpeed *
    UnityEngine_1.Time.fixedDeltaTime * (Upgrades_1.default.walkSpeed * 0.9) * PlayerStats_1.default.walkBoost;\n       
    let translatedDirection = new UnityEngine_1.Vector3(this.moveDirection.x * speed,
    0, this.moveDirection.y * speed);\n        this.rb.MovePosition(UnityEngine_1.Vector3.op_Addition(this.transform.position,
    translatedDirection));\n    }\n    RotatePlayer() {\n        if (UnityEngine_1.Vector3.op_Equality(this.moveDirection,
    UnityEngine_1.Vector3.zero))\n            return;\n        let translatedDirection
    = new UnityEngine_1.Vector3(this.moveDirection.x, 0, this.moveDirection.y);\n       
    let newRotation = UnityEngine_1.Quaternion.LookRotation(translatedDirection,
    UnityEngine_1.Vector3.up);\n        this.transform.rotation = newRotation;\n   
    }\n    OnTriggerEnter(coll) {\n        //console.log(`log : Hello World`);\n       
    if (coll.tag == \"Tree\") {\n            const tree = // @ts-ignore\n            
    coll.GetComponent(\"@assets/Experience/tower-of-time/Scripts/TreeObject.TreeObject\");\n           
    tree.StartChopping();\n        }\n    }\n    OnTriggerExit(coll) {\n        if
    (coll.tag == \"Tree\") {\n            const tree = // @ts-ignore\n            
    coll.GetComponent(\"@assets/Experience/tower-of-time/Scripts/TreeObject.TreeObject\");\n           
    tree.StopChopping();\n        }\n    }\n}\nexports.default = PlayerController;\n//#
    sourceMappingURL=data:application/json;charset=utf-8;base64,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SyxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUM7UUFDcEcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxZQUFZLENBQUMscUJBQU8sQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLEVBQUUsbUJBQW1CLENBQUMsQ0FBQztJQUMzRjtJQUVRLFlBQVk7UUFFaEIsSUFBRyxrQ0FBQyxJQUFJLENBQUMsYUFBWSxFQUFLLHFCQUFPLENBQUMsSUFBSTtZQUNsQyxPQUFNO1FBRVYsSUFBSSxtQkFBbUIsR0FBRyxJQUFJLHFCQUFPLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDO1FBQ3BGLElBQUksV0FBVyxHQUFHLHdCQUFVLENBQUMsWUFBWSxDQUFDLG1CQUFtQixFQUFFLHFCQUFPLENBQUMsRUFBRSxDQUFDO1FBRTFFLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxHQUFHLFdBQVc7SUFDekM7SUFFQSxjQUFjLENBQUMsSUFBYztRQUV6QixtQ0FBa0M7UUFFbEMsSUFBSSxJQUFJLENBQUMsR0FBRyxJQUFJLE1BQU0sRUFDdEI7WUFDSSxNQUFNLElBQUksR0FBRTthQUFDLElBQUksQ0FBQyxZQUFXLGlFQUFXLENBQUk7WUFDNUMsSUFBSSxDQUFDLGFBQWEsRUFBRTtRQUN4QjtJQUNKO0lBRUEsYUFBYSxDQUFDLElBQWM7UUFFeEIsSUFBSSxJQUFJLENBQUMsR0FBRyxJQUFJLE1BQU0sRUFDbEI7WUFDSSxNQUFNLElBQUksR0FBRTthQUFDLElBQUksQ0FBQyxZQUFXLGlFQUFXLENBQUk7WUFDNUMsSUFBSSxDQUFDLFlBQVksRUFBRTtRQUN2QjtJQUNSO0NBQ0o7QUF0SkEsbUNBc0pBIiwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlcyI6WyJQbGF5ZXJDb250cm9sbGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbbnVsbF19","ScriptHash":"2134e459f1b3f7ac83106e9dbde5e99d","Specifier":"@assets/Experience/tower-of-time/Scripts/PlayerController","DefaultTypeName":"@assets/Experience/tower-of-time/Scripts/PlayerController.PlayerController","IsMonobehaviour":true,"IsScriptableObj":false,"InheritanceChain":["@assets/Experience/tower-of-time/Scripts/PlayerController.PlayerController","UnityEngine.MonoBehaviour","UnityEngine.Behaviour","UnityEngine.Component","UnityEngine.Object","@com.genies.scripting@1.13.0\\Runtime\\Typing\\index.d.System.Object"],"Properties":[{"Path":"playerSpeed","Name":"playerSpeed","TypeName":"System.Single","AssemblyName":null,"EnumKeys":[],"EnumValues":[],"IsGeniesBehaviourRef":false,"IsGeniesScriptableObjectRef":false,"Decorators":[{"Type":"Header","Args":["\"Player
    Settings\""]},{"Type":"SerializeField","Args":[]}],"Initializers":["2.2"],"ArrayDimension":-1,"IsArray":false,"IsEnum":false,"ArrayElementInitializer":null,"ChildProperties":[],"PrettyName":"Player
    Speed","_arrayElementInitializerJson":null,"_childPropertiesJson":"[]","_prettyName":null},{"Path":"playerAnimator","Name":"playerAnimator","TypeName":"UnityEngine.RuntimeAnimatorController","AssemblyName":null,"EnumKeys":[],"EnumValues":[],"IsGeniesBehaviourRef":false,"IsGeniesScriptableObjectRef":false,"Decorators":[{"Type":"SerializeField","Args":[]}],"Initializers":[],"ArrayDimension":-1,"IsArray":false,"IsEnum":false,"ArrayElementInitializer":null,"ChildProperties":[],"PrettyName":"Player
    Animator","_arrayElementInitializerJson":null,"_childPropertiesJson":"[]","_prettyName":null},{"Path":"cameraTarget","Name":"cameraTarget","TypeName":"UnityEngine.Transform","AssemblyName":null,"EnumKeys":[],"EnumValues":[],"IsGeniesBehaviourRef":false,"IsGeniesScriptableObjectRef":false,"Decorators":[{"Type":"SerializeField","Args":[]}],"Initializers":[],"ArrayDimension":-1,"IsArray":false,"IsEnum":false,"ArrayElementInitializer":null,"ChildProperties":[],"PrettyName":"Camera
    Target","_arrayElementInitializerJson":null,"_childPropertiesJson":"[]","_prettyName":null},{"Path":"rb","Name":"rb","TypeName":"UnityEngine.Rigidbody","AssemblyName":null,"EnumKeys":[],"EnumValues":[],"IsGeniesBehaviourRef":false,"IsGeniesScriptableObjectRef":false,"Decorators":[{"Type":"SerializeField","Args":[]}],"Initializers":[],"ArrayDimension":-1,"IsArray":false,"IsEnum":false,"ArrayElementInitializer":null,"ChildProperties":[],"PrettyName":"Rb","_arrayElementInitializerJson":null,"_childPropertiesJson":"[]","_prettyName":null}],"SupportedUiEvents":"None"}'
