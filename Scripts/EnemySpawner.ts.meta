fileFormatVersion: 2
guid: c53c30fe9917dbe45941d22f3a8cc699
ScriptedImporter:
  internalIDToNameTable: []
  externalObjects: {}
  serializedVersion: 2
  userData: 
  assetBundleName: 
  assetBundleVariant: 
  script: {fileID: 11500000, guid: 22604dd76f55453daccee3ed9e7b94b5, type: 3}
  SerializedAsset: '{"IsCompiled":true,"CompilerVersion":"2.0.63","ReferencedSpecifiers":["@assets/Experience/tower-of-time/Scripts/RoundManager","@assets/Experience/tower-of-time/Scripts/Turret","@assets/Experience/tower-of-time/Scripts/Building"],"Source":"\"use
    strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst
    UnityEngine_1 = require(\"UnityEngine\");\nconst RoundManager_1 = require(\"@assets/Experience/tower-of-time/Scripts/RoundManager\");\nclass
    EnemySpawner extends UnityEngine_1.MonoBehaviour {\n    constructor() {\n       
    super(...arguments);\n        this.turrets = new Array(6);\n        this.layerMask
    = (1 << UnityEngine_1.LayerMask.NameToLayer(\"CustomLayer2\")) | (1 << UnityEngine_1.LayerMask.NameToLayer(\"CustomLayer6\"));\n   
    }\n    //Called when script instance is loaded\n    Awake() { }\n    //Start
    is called on the frame when a script is enabled just \n    //before any of the
    Update methods are called the first time.\n    Start() {\n        EnemySpawner.spawnFrequenzy
    = 5.0;\n        EnemySpawner.killAll = false;\n        EnemySpawner.isSpawning
    = false;\n        EnemySpawner.startSwarming = false;\n        EnemySpawner.wormsAlive
    = 0;\n        // Find turret references\n        let turretsFound = UnityEngine_1.GameObject.FindGameObjectsWithTag(\"Turret\");\n       
    console.log(turretsFound.length);\n        for (let i = 0; i < turretsFound.length;
    i++) {\n            this.turrets[i] = // @ts-ignore\n                turretsFound[i].GetComponent(\"@assets/Experience/tower-of-time/Scripts/Turret.Turret\");\n           
    console.log(// @ts-ignore\n            turretsFound[i].GetComponent(\"@assets/Experience/tower-of-time/Scripts/Turret.Turret\"));\n           
    this.turrets[i].gameObject.SetActive(false);\n        }\n        this.StartCoroutine(this.Spawner());\n   
    }\n    //Update is called every frame, if the MonoBehaviour is enabled.\n   
    Update() { }\n    *Spawner() {\n        while (true) {\n            // Wait\n           
    let freq = (RoundManager_1.default.swarmRound) ? EnemySpawner.spawnFrequenzy
    / 2.0 : EnemySpawner.spawnFrequenzy;\n            yield new UnityEngine_1.WaitForSeconds(freq);\n           
    if (!EnemySpawner.isSpawning)\n                continue;\n            // Start
    Swarming if it''s a swarm round, otherwise just spawn as usual\n            if
    (EnemySpawner.startSwarming) {\n                // Spawn a swarm to start the
    round\n                let c = 10;\n                c += RoundManager_1.default.round
    * 2;\n                while (c > 0) {\n                    c--;\n                   
    let spawnPosition = this.FindSpawnPosition();\n                    UnityEngine_1.Object.Instantiate(this.enemy,
    spawnPosition, UnityEngine_1.Quaternion.identity, this.transform);\n                   
    // Increase count\n                    EnemySpawner.wormsAlive++;\n                   
    yield new UnityEngine_1.WaitForSeconds(0.1);\n                }\n               
    EnemySpawner.startSwarming = false;\n            }\n            // Look for spawn
    point\n            let spawnPosition = this.FindSpawnPosition();\n           
    if (EnemySpawner.wormsAlive < 100) {\n                // Spawn enemy\n               
    UnityEngine_1.Object.Instantiate(this.enemy, spawnPosition, UnityEngine_1.Quaternion.identity,
    this.transform);\n                // Increase count\n                EnemySpawner.wormsAlive++;\n               
    console.log(EnemySpawner.wormsAlive);\n            }\n        }\n    }\n    FindSpawnPosition()
    {\n        let spawnPos = UnityEngine_1.Vector3.zero;\n        // max 100 tries
    to prevent crash\n        let spawnFound = false;\n        let count = 100;\n       
    while (!spawnFound && count > 0) {\n            count--;\n            // Make
    a random position in the world based on the size of the island\n            let
    xRandom = // @ts-ignore\n             UnityEngine_1.Random.Range_EBB7509C_H1075CF37(-15.0,
    18.0);\n            let zRandom = // @ts-ignore\n             UnityEngine_1.Random.Range_EBB7509C_H1075CF37(-17.0,
    10.0);\n            let randomPosition = new UnityEngine_1.Vector3(xRandom, 0,
    zRandom);\n            // Make sure the random position is far away enough from
    the player, to prevent seeing the enemies spawn\n            if (this.IsTooCloseToPlayer(randomPosition)
    == true)\n                continue;\n            // If randomPosition is not
    too close, check if the position is okay to spawn at, or if there is a collider
    in the way\n            randomPosition.y = 10;\n            let ray = new UnityEngine_1.Ray(randomPosition,
    UnityEngine_1.Vector3.down);\n            let hit = $ref();\n            if (
    // @ts-ignore\n            UnityEngine_1.Physics.Raycast_EBB7509C_C446A765(ray,
    hit, (20), this.layerMask)) {\n                if ($unref(hit).transform.tag
    == \"SpawnArea\") {\n                    // Found a spawn point!\n                   
    spawnPos = $unref(hit).point;\n                    spawnFound = true;\n               
    }\n                else {\n                    // No spawn found, try again\n                   
    //console.log(`No Spawn was Found`);\n                }\n            }\n       
    }\n        return spawnPos;\n    }\n    IsTooCloseToPlayer(randomPosition) {\n       
    let inRange = false;\n        let playerPosition = this.player.position;\n       
    let xMin = playerPosition.x - 6.0; // 4 > 6\n        let xMax = playerPosition.x
    + 6.0;\n        let zMax = playerPosition.z + 12.0;\n        let zMin = playerPosition.z
    - 13.0;\n        if (randomPosition.x < xMax && randomPosition.x > xMin && randomPosition.z
    < zMax && randomPosition.z > zMin) {\n            inRange = true;\n        }\n       
    //else if (randomPosition.z < zMax && randomPosition.z > zMin)\n        //{\n       
    //    inRange = true;\n        //}\n        return inRange;\n    }\n    GameOver()
    {\n        this.StopAllCoroutines();\n    }\n}\nEnemySpawner.spawnFrequenzy =
    5.0;\nEnemySpawner.wormsAlive = 0;\nexports.default = EnemySpawner;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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","ScriptHash":"574e1f5292bfc4dc296bc93e8878ffb2","Specifier":"@assets/Experience/tower-of-time/Scripts/EnemySpawner","DefaultTypeName":"@assets/Experience/tower-of-time/Scripts/EnemySpawner.EnemySpawner","IsMonobehaviour":true,"IsScriptableObj":false,"InheritanceChain":["@assets/Experience/tower-of-time/Scripts/EnemySpawner.EnemySpawner","UnityEngine.MonoBehaviour","UnityEngine.Behaviour","UnityEngine.Component","UnityEngine.Object","@com.genies.scripting@1.11.0\\Runtime\\Typing\\index.d.System.Object"],"Properties":[{"Path":"enemy","Name":"enemy","TypeName":"UnityEngine.GameObject","AssemblyName":null,"EnumKeys":[],"EnumValues":[],"IsGeniesBehaviourRef":false,"IsGeniesScriptableObjectRef":false,"Decorators":[{"Type":"SerializeField","Args":[]}],"Initializers":[],"ArrayDimension":-1,"IsArray":false,"IsEnum":false,"ArrayElementInitializer":null,"ChildProperties":[],"PrettyName":"Enemy","_arrayElementInitializerJson":null,"_childPropertiesJson":"[]","_prettyName":null},{"Path":"player","Name":"player","TypeName":"UnityEngine.Transform","AssemblyName":null,"EnumKeys":[],"EnumValues":[],"IsGeniesBehaviourRef":false,"IsGeniesScriptableObjectRef":false,"Decorators":[{"Type":"SerializeField","Args":[]}],"Initializers":[],"ArrayDimension":-1,"IsArray":false,"IsEnum":false,"ArrayElementInitializer":null,"ChildProperties":[],"PrettyName":"Player","_arrayElementInitializerJson":null,"_childPropertiesJson":"[]","_prettyName":null}],"SupportedUiEvents":"None","DisplayName":"EnemySpawner","name":"EnemySpawner","hideFlags":"NotEditable"}'
